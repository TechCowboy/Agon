Zilog eZ80 Macro Assembler Version 4.3 (19073001)02-Aug-22     20:52:09     page:   1


PC     Object              I  Line    Source 
                           A     1    ; Zilog eZ80 ANSI C Compiler Release 3.4
                           A     2    ; -nomodsect -optspeed -noreduceopt -nopadbranc
                           A     3    ; -peephole -globalopt -localcse -const=ROM 
                           A     4    	FILE	"..\src\game.c"
                           A     5    	.assume ADL=1
                           A     6    .DEBUG "C"
                           A     7    	SEGMENT CODE
                           A     8    .BEGREC "sokobanlevel",307
                           A     9    .DEFINE "xpos"
                           A    10    .VALUE 0
                           A    11    .CLASS 8
                           A    12    .TYPE 12
                           A    13    .ENDEF
                           A    14    .DEFINE "ypos"
                           A    15    .VALUE 1
                           A    16    .CLASS 8
                           A    17    .TYPE 12
                           A    18    .ENDEF
                           A    19    .DEFINE "width"
                           A    20    .VALUE 2
                           A    21    .CLASS 8
                           A    22    .TYPE 12
                           A    23    .ENDEF
                           A    24    .DEFINE "height"
                           A    25    .VALUE 3
                           A    26    .CLASS 8
                           A    27    .TYPE 12
                           A    28    .ENDEF
                           A    29    .DEFINE "goals"
                           A    30    .VALUE 4
                           A    31    .CLASS 8
                           A    32    .TYPE 12
                           A    33    .ENDEF
                           A    34    .DEFINE "goalstaken"
                           A    35    .VALUE 5
                           A    36    .CLASS 8
                           A    37    .TYPE 12
                           A    38    .ENDEF
                           A    39    .DEFINE "crates"
                           A    40    .VALUE 6
                           A    41    .CLASS 8
                           A    42    .TYPE 12
                           A    43    .ENDEF
                           A    44    .DEFINE "data"
                           A    45    .VALUE 7
                           A    46    .CLASS 8
                           A    47    .DIM 15
                           A    48    .DIM 20
                           A    49    .TYPE 876
                           A    50    .ENDEF
                           A    51    .ENDREC "sokobanlevel"
                           A    52    .BEGREC "NONAME0",2
                           A    53    .DEFINE "ch"
                           A    54    .VALUE 0
                           A    55    .CLASS 8
                           A    56    .TYPE 2
                           A    57    .ENDEF
                           A    58    .DEFINE "tile_id"
                           A    59    .VALUE 1
                           A    60    .CLASS 8
                           A    61    .TYPE 12
                           A    62    .ENDEF
                           A    63    .ENDREC "NONAME0"
                           A    64    .BEGREC "fmt_type",19
                           A    65    .DEFINE "status"
                           A    66    .VALUE 0
                           A    67    .CLASS 8
                           A    68    .TYPE 12
                           A    69    .ENDEF
                           A    70    .DEFINE "flags"
                           A    71    .VALUE 1
                           A    72    .CLASS 8
                           A    73    .TYPE 12
                           A    74    .ENDEF
                           A    75    .DEFINE "size"
                           A    76    .VALUE 2
                           A    77    .CLASS 8
                           A    78    .TYPE 2
                           A    79    .ENDEF
                           A    80    .DEFINE "chr"
                           A    81    .VALUE 3
                           A    82    .CLASS 8
                           A    83    .TYPE 2
                           A    84    .ENDEF
                           A    85    .DEFINE "type"
                           A    86    .VALUE 4
                           A    87    .CLASS 8
                           A    88    .TYPE 2
                           A    89    .ENDEF
                           A    90    .DEFINE "field_width"
                           A    91    .VALUE 5
                           A    92    .CLASS 8
                           A    93    .TYPE 2
                           A    94    .ENDEF
                           A    95    .DEFINE "precision"
                           A    96    .VALUE 6
                           A    97    .CLASS 8
                           A    98    .TYPE 2
                           A    99    .ENDEF
                           A   100    .DEFINE "set_begin"
                           A   101    .VALUE 7
                           A   102    .CLASS 8
                           A   103    .TYPE 34
                           A   104    .ENDEF
                           A   105    .DEFINE "set_end"
                           A   106    .VALUE 10
                           A   107    .CLASS 8
                           A   108    .TYPE 34
                           A   109    .ENDEF
                           A   110    .DEFINE "pad_whole"
                           A   111    .VALUE 13
                           A   112    .CLASS 8
                           A   113    .TYPE 12
                           A   114    .ENDEF
                           A   115    .DEFINE "pad_pre_fract"
                           A   116    .VALUE 14
                           A   117    .CLASS 8
                           A   118    .TYPE 12
                           A   119    .ENDEF
                           A   120    .DEFINE "pad_post_fract"
                           A   121    .VALUE 15
                           A   122    .CLASS 8
                           A   123    .TYPE 12
                           A   124    .ENDEF
                           A   125    .DEFINE "pad_at"
                           A   126    .VALUE 16
                           A   127    .CLASS 8
                           A   128    .TYPE 34
                           A   129    .ENDEF
                           A   130    .ENDREC "fmt_type"
                           A   131    .BEGREC "flt_info",12
                           A   132    .DEFINE "flags"
                           A   133    .VALUE 0
                           A   134    .CLASS 8
                           A   135    .TYPE 12
                           A   136    .ENDEF
                           A   137    .DEFINE "exp"
                           A   138    .VALUE 1
                           A   139    .CLASS 8
                           A   140    .TYPE 2
                           A   141    .ENDEF
                           A   142    .DEFINE "digits"
                           A   143    .VALUE 2
                           A   144    .CLASS 8
                           A   145    .DIM 10
                           A   146    .TYPE 108
                           A   147    .ENDEF
                           A   148    .ENDREC "flt_info"
                           A   149    .BEGREC "NONAME1",6
                           A   150    .DEFINE "quot"
                           A   151    .VALUE 0
                           A   152    .CLASS 8
                           A   153    .TYPE 4
                           A   154    .ENDEF
                           A   155    .DEFINE "rem"
                           A   156    .VALUE 3
                           A   157    .CLASS 8
                           A   158    .TYPE 4
                           A   159    .ENDEF
                           A   160    .ENDREC "NONAME1"
                           A   161    .BEGREC "NONAME2",8
                           A   162    .DEFINE "quot"
                           A   163    .VALUE 0
                           A   164    .CLASS 8
                           A   165    .TYPE 5
                           A   166    .ENDEF
                           A   167    .DEFINE "rem"
                           A   168    .VALUE 4
                           A   169    .CLASS 8
                           A   170    .TYPE 5
                           A   171    .ENDEF
                           A   172    .ENDREC "NONAME2"
                           A   173    .BEGREC "header",6
                           A   174    .DEFINE "s"
                           A   175    .VALUE 0
                           A   176    .CLASS 11
                           A   177    .TAG "NONAME3"
                           A   178    .TYPE 8
                           A   179    .ENDEF
                           A   180    .DEFINE "x"
                           A   181    .VALUE 0
                           A   182    .CLASS 11
                           A   183    .TYPE 2
                           A   184    .ENDEF
                           A   185    .ENDREC "header"
                           A   186    .BEGREC "NONAME3",6
                           A   187    .DEFINE "ptr"
                           A   188    .VALUE 0
                           A   189    .CLASS 8
                           A   190    .TAG "header"
                           A   191    .TYPE 40
                           A   192    .ENDEF
                           A   193    .DEFINE "size"
                           A   194    .VALUE 3
                           A   195    .CLASS 8
                           A   196    .TYPE 14
                           A   197    .ENDEF
                           A   198    .ENDREC "NONAME3"
                           A   199    .BEGREC "NONAME4",562
                           A   200    .DEFINE "fs_type"
                           A   201    .VALUE 0
                           A   202    .CLASS 8
                           A   203    .TYPE 12
                           A   204    .ENDEF
                           A   205    .DEFINE "pdrv"
                           A   206    .VALUE 1
                           A   207    .CLASS 8
                           A   208    .TYPE 12
                           A   209    .ENDEF
                           A   210    .DEFINE "n_fats"
                           A   211    .VALUE 2
                           A   212    .CLASS 8
                           A   213    .TYPE 12
                           A   214    .ENDEF
                           A   215    .DEFINE "wflag"
                           A   216    .VALUE 3
                           A   217    .CLASS 8
                           A   218    .TYPE 12
                           A   219    .ENDEF
                           A   220    .DEFINE "fsi_flag"
                           A   221    .VALUE 4
                           A   222    .CLASS 8
                           A   223    .TYPE 12
                           A   224    .ENDEF
                           A   225    .DEFINE "id"
                           A   226    .VALUE 5
                           A   227    .CLASS 8
                           A   228    .TYPE 13
                           A   229    .ENDEF
                           A   230    .DEFINE "n_rootdir"
                           A   231    .VALUE 7
                           A   232    .CLASS 8
                           A   233    .TYPE 13
                           A   234    .ENDEF
                           A   235    .DEFINE "csize"
                           A   236    .VALUE 9
                           A   237    .CLASS 8
                           A   238    .TYPE 13
                           A   239    .ENDEF
                           A   240    .DEFINE "lfnbuf"
                           A   241    .VALUE 11
                           A   242    .CLASS 8
                           A   243    .TYPE 45
                           A   244    .ENDEF
                           A   245    .DEFINE "last_clst"
                           A   246    .VALUE 14
                           A   247    .CLASS 8
                           A   248    .TYPE 15
                           A   249    .ENDEF
                           A   250    .DEFINE "free_clst"
                           A   251    .VALUE 18
                           A   252    .CLASS 8
                           A   253    .TYPE 15
                           A   254    .ENDEF
                           A   255    .DEFINE "n_fatent"
                           A   256    .VALUE 22
                           A   257    .CLASS 8
                           A   258    .TYPE 15
                           A   259    .ENDEF
                           A   260    .DEFINE "fsize"
                           A   261    .VALUE 26
                           A   262    .CLASS 8
                           A   263    .TYPE 15
                           A   264    .ENDEF
                           A   265    .DEFINE "volbase"
                           A   266    .VALUE 30
                           A   267    .CLASS 8
                           A   268    .TYPE 15
                           A   269    .ENDEF
                           A   270    .DEFINE "fatbase"
                           A   271    .VALUE 34
                           A   272    .CLASS 8
                           A   273    .TYPE 15
                           A   274    .ENDEF
                           A   275    .DEFINE "dirbase"
                           A   276    .VALUE 38
                           A   277    .CLASS 8
                           A   278    .TYPE 15
                           A   279    .ENDEF
                           A   280    .DEFINE "database"
                           A   281    .VALUE 42
                           A   282    .CLASS 8
                           A   283    .TYPE 15
                           A   284    .ENDEF
                           A   285    .DEFINE "winsect"
                           A   286    .VALUE 46
                           A   287    .CLASS 8
                           A   288    .TYPE 15
                           A   289    .ENDEF
                           A   290    .DEFINE "win"
                           A   291    .VALUE 50
                           A   292    .CLASS 8
                           A   293    .DIM 512
                           A   294    .TYPE 108
                           A   295    .ENDEF
                           A   296    .ENDREC "NONAME4"
                           A   297    .BEGREC "NONAME5",15
                           A   298    .DEFINE "fs"
                           A   299    .VALUE 0
                           A   300    .CLASS 8
                           A   301    .TAG "NONAME4"
                           A   302    .TYPE 40
                           A   303    .ENDEF
                           A   304    .DEFINE "id"
                           A   305    .VALUE 3
                           A   306    .CLASS 8
                           A   307    .TYPE 13
                           A   308    .ENDEF
                           A   309    .DEFINE "attr"
                           A   310    .VALUE 5
                           A   311    .CLASS 8
                           A   312    .TYPE 12
                           A   313    .ENDEF
                           A   314    .DEFINE "stat"
                           A   315    .VALUE 6
                           A   316    .CLASS 8
                           A   317    .TYPE 12
                           A   318    .ENDEF
                           A   319    .DEFINE "sclust"
                           A   320    .VALUE 7
                           A   321    .CLASS 8
                           A   322    .TYPE 15
                           A   323    .ENDEF
                           A   324    .DEFINE "objsize"
                           A   325    .VALUE 11
                           A   326    .CLASS 8
                           A   327    .TYPE 15
                           A   328    .ENDEF
                           A   329    .ENDREC "NONAME5"
                           A   330    .BEGREC "NONAME6",548
                           A   331    .DEFINE "obj"
                           A   332    .VALUE 0
                           A   333    .CLASS 8
                           A   334    .TAG "NONAME5"
                           A   335    .TYPE 8
                           A   336    .ENDEF
                           A   337    .DEFINE "flag"
                           A   338    .VALUE 15
                           A   339    .CLASS 8
                           A   340    .TYPE 12
                           A   341    .ENDEF
                           A   342    .DEFINE "err"
                           A   343    .VALUE 16
                           A   344    .CLASS 8
                           A   345    .TYPE 12
                           A   346    .ENDEF
                           A   347    .DEFINE "fptr"
                           A   348    .VALUE 17
                           A   349    .CLASS 8
                           A   350    .TYPE 15
                           A   351    .ENDEF
                           A   352    .DEFINE "clust"
                           A   353    .VALUE 21
                           A   354    .CLASS 8
                           A   355    .TYPE 15
                           A   356    .ENDEF
                           A   357    .DEFINE "sect"
                           A   358    .VALUE 25
                           A   359    .CLASS 8
                           A   360    .TYPE 15
                           A   361    .ENDEF
                           A   362    .DEFINE "dir_sect"
                           A   363    .VALUE 29
                           A   364    .CLASS 8
                           A   365    .TYPE 15
                           A   366    .ENDEF
                           A   367    .DEFINE "dir_ptr"
                           A   368    .VALUE 33
                           A   369    .CLASS 8
                           A   370    .TYPE 44
                           A   371    .ENDEF
                           A   372    .DEFINE "buf"
                           A   373    .VALUE 36
                           A   374    .CLASS 8
                           A   375    .DIM 512
                           A   376    .TYPE 108
                           A   377    .ENDEF
                           A   378    .ENDREC "NONAME6"
                           A   379    .BEGREC "NONAME7",46
                           A   380    .DEFINE "obj"
                           A   381    .VALUE 0
                           A   382    .CLASS 8
                           A   383    .TAG "NONAME5"
                           A   384    .TYPE 8
                           A   385    .ENDEF
                           A   386    .DEFINE "dptr"
                           A   387    .VALUE 15
                           A   388    .CLASS 8
                           A   389    .TYPE 15
                           A   390    .ENDEF
                           A   391    .DEFINE "clust"
                           A   392    .VALUE 19
                           A   393    .CLASS 8
                           A   394    .TYPE 15
                           A   395    .ENDEF
                           A   396    .DEFINE "sect"
                           A   397    .VALUE 23
                           A   398    .CLASS 8
                           A   399    .TYPE 15
                           A   400    .ENDEF
                           A   401    .DEFINE "dir"
                           A   402    .VALUE 27
                           A   403    .CLASS 8
                           A   404    .TYPE 44
                           A   405    .ENDEF
                           A   406    .DEFINE "fn"
                           A   407    .VALUE 30
                           A   408    .CLASS 8
                           A   409    .DIM 12
                           A   410    .TYPE 108
                           A   411    .ENDEF
                           A   412    .DEFINE "blk_ofs"
                           A   413    .VALUE 42
                           A   414    .CLASS 8
                           A   415    .TYPE 15
                           A   416    .ENDEF
                           A   417    .ENDREC "NONAME7"
                           A   418    .BEGREC "NONAME8",278
                           A   419    .DEFINE "fsize"
                           A   420    .VALUE 0
                           A   421    .CLASS 8
                           A   422    .TYPE 15
                           A   423    .ENDEF
                           A   424    .DEFINE "fdate"
                           A   425    .VALUE 4
                           A   426    .CLASS 8
                           A   427    .TYPE 13
                           A   428    .ENDEF
                           A   429    .DEFINE "ftime"
                           A   430    .VALUE 6
                           A   431    .CLASS 8
                           A   432    .TYPE 13
                           A   433    .ENDEF
                           A   434    .DEFINE "fattrib"
                           A   435    .VALUE 8
                           A   436    .CLASS 8
                           A   437    .TYPE 12
                           A   438    .ENDEF
                           A   439    .DEFINE "altname"
                           A   440    .VALUE 9
                           A   441    .CLASS 8
                           A   442    .DIM 13
                           A   443    .TYPE 98
                           A   444    .ENDEF
                           A   445    .DEFINE "fname"
                           A   446    .VALUE 22
                           A   447    .CLASS 8
                           A   448    .DIM 256
                           A   449    .TYPE 98
                           A   450    .ENDEF
                           A   451    .ENDREC "NONAME8"
                           A   452    .BEGREC "NONAME9",12
                           A   453    .DEFINE "fmt"
                           A   454    .VALUE 0
                           A   455    .CLASS 8
                           A   456    .TYPE 12
                           A   457    .ENDEF
                           A   458    .DEFINE "n_fat"
                           A   459    .VALUE 1
                           A   460    .CLASS 8
                           A   461    .TYPE 12
                           A   462    .ENDEF
                           A   463    .DEFINE "align"
                           A   464    .VALUE 2
                           A   465    .CLASS 8
                           A   466    .TYPE 14
                           A   467    .ENDEF
                           A   468    .DEFINE "n_root"
                           A   469    .VALUE 5
                           A   470    .CLASS 8
                           A   471    .TYPE 14
                           A   472    .ENDEF
                           A   473    .DEFINE "au_size"
                           A   474    .VALUE 8
                           A   475    .CLASS 8
                           A   476    .TYPE 15
                           A   477    .ENDEF
                           A   478    .ENDREC "NONAME9"
                           A   479    .BEGREC "NONAME10",6
                           A   480    .DEFINE "name"
                           A   481    .VALUE 0
                           A   482    .CLASS 8
                           A   483    .TYPE 34
                           A   484    .ENDEF
                           A   485    .DEFINE "func"
                           A   486    .VALUE 3
                           A   487    .CLASS 8
                           A   488    .TYPE 548
                           A   489    .ENDEF
                           A   490    .ENDREC "NONAME10"
                           A   491    	SEGMENT TEXT
000000                     A   492    _lookup:
000000 23                  A   493    	DB	35
000001 00                  A   494    	DB	0
000002 40                  A   495    	DB	64
000003 01                  A   496    	DB	1
000004 2B                  A   497    	DB	43
000005 02                  A   498    	DB	2
000006 24                  A   499    	DB	36
000007 03                  A   500    	DB	3
000008 2A                  A   501    	DB	42
000009 04                  A   502    	DB	4
00000A 2E                  A   503    	DB	46
00000B 05                  A   504    	DB	5
00000C 20                  A   505    	DB	32
00000D 06                  A   506    	DB	6
                           A   507    .DEFINE "lookup"
                           A   508    .ALIAS "_lookup"
                           A   509    .CLASS 84
                           A   510    .VALUE _lookup
                           A   511    .DIM 7
                           A   512    .TAG "NONAME0"
                           A   513    .TYPE 104
                           A   514    .ENDEF
                           A   515    ;    1	#include "game.h"
                           A   516    ;    2	#include "sokobanprep.h"
                           A   517    ;    3	#include <defines.h>
                           A   518    ;    4	#include <stdio.h>
                           A   519    ;    5	#include <stdlib.h>
                           A   520    ;    6	
                           A   521    ;    7	#include "ff.h"
                           A   522    ;    8	#include "mos.h"
                           A   523    ;    9	
                           A   524    ;   10	const chartotile lookup[] =
                           A   525    ;   11	{
                           A   526    	SEGMENT CODE
                           A   527    ;   12		{CHAR_WALL, TILE_WALL},
                           A   528    ;   13		{CHAR_PLAYER, TILE_PLAYER},
                           A   529    ;   14		{CHAR_PLAYERONGOAL, TILE_PLAYERONGO
                           A   530    ;   15		{CHAR_BOX, TILE_BOX},
                           A   531    ;   16		{CHAR_BOXONGOAL, TILE_BOXONGOAL},
                           A   532    ;   17		{CHAR_GOAL, TILE_GOAL},
                           A   533    ;   18		{CHAR_FLOOR, TILE_FLOOR}
                           A   534    ;   19	};
                           A   535    ;   20	
                           A   536    ;   21	void print_playfieldText(struct sokoban
                           A   537    ;   22	{
000000                     A   538    _print_playfieldText:
                           A   539    .DEFINE "_print_playfieldText"
                           A   540    
                           A   541    .VALUE _print_playfieldText
                           A   542    
                           A   543    .CLASS 2
                           A   544    
                           A   545    .TYPE 65
                           A   546    
                           A   547    .ENDEF
                           A   548    
                           A   549    .BEGFUNC "print_playfieldText",22,"_print_playf
                           A   550    
                           A   551    .LINE 22
                           A   552    
                           A   553    .DEFINE "level"
                           A   554    
                           A   555    .CLASS 65
                           A   556    
                           A   557    .VALUE 6
                           A   558    
                           A   559    .TAG "sokobanlevel"
                           A   560    
                           A   561    .TYPE 40
                           A   562    
                           A   563    .ENDEF
                           A   564    
                           A   565    .DEFINE "width"
                           A   566    
                           A   567    .CLASS 65
                           A   568    
                           A   569    .VALUE -2
                           A   570    
                           A   571    .TYPE 13
                           A   572    
                           A   573    .ENDEF
                           A   574    
                           A   575    .DEFINE "height"
                           A   576    
                           A   577    .CLASS 65
                           A   578    
                           A   579    .VALUE -4
                           A   580    
                           A   581    .TYPE 13
                           A   582    
                           A   583    .ENDEF
                           A   584    
                           A   585    .DEFINE "c"
                           A   586    
                           A   587    .CLASS 65
                           A   588    
                           A   589    .VALUE -5
                           A   590    
                           A   591    .TYPE 2
                           A   592    
                           A   593    .ENDEF
                           A   594    
000000 DDE5                A   595    	PUSH	IX
000002 DD210000 00         A   596    	LD	IX,0
000007 DD39                A   597    	ADD	IX,SP
000009 C5                  A   598    	PUSH	BC
00000A C5                  A   599    	PUSH	BC
00000B 3B                  A   600    	DEC	SP
00000C 3B                  A   601    	DEC	SP
                           A   602    ;   23		UINT16 width, height;
                           A   603    ;   24		char c;
                           A   604    ;   25		
                           A   605    ;   26		for(height = 0; height < level->hei
                           A   606    .LINE 26
                           A   607    
00000D DD36FC00            A   608    	LD	(IX+%FFFFFFFC),%0
000011 DD36FD00            A   609    	LD	(IX+%FFFFFFFD),%0
000015 C3 AB 00 00         A   610    	JR	L_12
000019                     A   611    L_10:
                           A   612    ;   27		{
                           A   613    ;   28			for(width = 0; width < level->w
                           A   614    .LINE 28
                           A   615    
000019 DD36FE00            A   616    	LD	(IX+%FFFFFFFE),%0
00001D DD36FF00            A   617    	LD	(IX+%FFFFFFFF),%0
000021 18 5A               A   618    	JR	L_8
000023                     A   619    L_6:
                           A   620    ;   29			{
                           A   621    ;   30				c = level->data[height][wid
                           A   622    .LINE 30
                           A   623    
000023 DD07FC              A   624    	LD	BC,(IX+%FFFFFFFC)
000026 CD 00 00 00         A   625    	CALL	__stoiu
00002A 3E14                A   626    	LD	A,%14
00002C CD 00 00 00         A   627    	CALL	__imul_b
000030 E5C1                A   628    	LD	BC,HL
000032 DD3106              A   629    	LD	IY,(IX+%6)
000035 ED2307              A   630    	LEA	HL,IY+%7
000038 09                  A   631    	ADD	HL,BC
000039 E5D1                A   632    	LD	DE,HL
00003B DD07FE              A   633    	LD	BC,(IX+%FFFFFFFE)
00003E CD 00 00 00         A   634    	CALL	__stoiu
000042 19                  A   635    	ADD	HL,DE
000043 7E                  A   636    	LD	A,(HL)
000044 DD77FB              A   637    	LD	(IX+%FFFFFFFB),A
                           A   638    ;   31				printf("%c",c?c:' ');
                           A   639    .LINE 31
                           A   640    
000047 B7                  A   641    	OR	A,A
000048 28 0E               A   642    	JR	Z,L_4
00004A DD7EFB              A   643    	LD	A,(IX+%FFFFFFFB)
00004D 17ED62              A   644    	SEXT	HL
000050 DD6EFB              A   645    	LD	L,(IX+%FFFFFFFB)
000053 DD2FF8              A   646    	LD	(IX+%FFFFFFF8),HL
000056 18 07               A   647    	JR	L_5
000058                     A   648    L_4:
000058 01200000            A   649    	LD	BC,32
00005C DD0FF8              A   650    	LD	(IX+%FFFFFFF8),BC
00005F                     A   651    L_5:
00005F 01 00 00 00         A   652    	LD	BC,___print_uputch
000063 ED43 00 00 00       A   653    	LD	(___print_xputch),BC
000068 DD4EF8              A   654    	LD	C,(IX+%FFFFFFF8)
00006B 0600                A   655    	LD	B,%0
00006D C5                  A   656    	PUSH	BC
00006E CD 00 00 00         A   657    	CALL	___print_uputch
000072 C1                  A   658    	POP	BC
000073 DD27FE              A   659    	LD	HL,(IX+%FFFFFFFE)
000076 23                  A   660    	INC	HL
000077 DD75FE              A   661    	LD	(IX+%FFFFFFFE),L
00007A DD74FF              A   662    	LD	(IX+%FFFFFFFF),H
                           A   663    ;   32			}
00007D                     A   664    L_8:
                           A   665    .LINE 32
                           A   666    
00007D DD3106              A   667    	LD	IY,(IX+%6)
000080 FD4E02              A   668    	LD	C,(IY+%2)
000083 0600                A   669    	LD	B,%0
000085 DD27FE              A   670    	LD	HL,(IX+%FFFFFFFE)
000088 B7                  A   671    	OR	A,A
000089 40ED42              A   672    	SBC.SIS	HL,BC
00008C 38 95               A   673    	JR	C,L_6
                           A   674    ;   33			printf("\n\r");
                           A   675    .LINE 33
                           A   676    
00008E 01 00 00 00         A   677    	LD	BC,___print_uputch
000092 ED43 00 00 00       A   678    	LD	(___print_xputch),BC
000097 01 00 00 00         A   679    	LD	BC,L__2
00009B C5                  A   680    	PUSH	BC
00009C CD 00 00 00         A   681    	CALL	___print_sendstring
0000A0 C1                  A   682    	POP	BC
0000A1 DD27FC              A   683    	LD	HL,(IX+%FFFFFFFC)
0000A4 23                  A   684    	INC	HL
0000A5 DD75FC              A   685    	LD	(IX+%FFFFFFFC),L
0000A8 DD74FD              A   686    	LD	(IX+%FFFFFFFD),H
                           A   687    ;   34		}
0000AB                     A   688    L_12:
                           A   689    .LINE 34
                           A   690    
0000AB DD3106              A   691    	LD	IY,(IX+%6)
0000AE FD4E03              A   692    	LD	C,(IY+%3)
0000B1 0600                A   693    	LD	B,%0
0000B3 DD27FC              A   694    	LD	HL,(IX+%FFFFFFFC)
0000B6 B7                  A   695    	OR	A,A
0000B7 40ED42              A   696    	SBC.SIS	HL,BC
0000BA DA 19 00 00         A   697    	JR	C,L_10
                           A   698    ;   35		
                           A   699    ;   36	}
                           A   700    .LINE 36
                           A   701    
0000BE DDF9                A   702    	LD	SP,IX
0000C0 DDE1                A   703    	POP	IX
0000C2 C9                  A   704    	RET	
                           A   705    
                           A   706    
                           A   707    ;**************************** _print_playfieldT
                           A   708    ;Name                         Addr/Register   S
                           A   709    ;___print_sendstring                 IMPORT  --
                           A   710    ;___print_xputch                     IMPORT    
                           A   711    ;___print_uputch                     IMPORT  --
                           A   712    ;temp2                                 IX-8    
                           A   713    ;c                                     IX-5    
                           A   714    ;height                                IX-4    
                           A   715    ;width                                 IX-2    
                           A   716    ;level                                 IX+6    
                           A   717    
                           A   718    
                           A   719    ; Stack Frame Size: 17 (bytes)
                           A   720    ;       Spill Code: 0 (instruction)
                           A   721    
                           A   722    
                           A   723    .ENDFUNC "print_playfieldText",36,"_print_playf
                           A   724    	SEGMENT STRSECT
000000                     A   725    L__2:
000000 0A0D00              A   726    	DB	10,13,0
                           A   727    	SEGMENT CODE
                           A   728    ;   37	
                           A   729    ;   38	UINT16 read_levels(char *filename, stru
                           A   730    ;   39	{
0000C3                     A   731    _read_levels:
                           A   732    .DEFINE "_read_levels"
                           A   733    
                           A   734    .VALUE _read_levels
                           A   735    
                           A   736    .CLASS 2
                           A   737    
                           A   738    .TYPE 77
                           A   739    
                           A   740    .ENDEF
                           A   741    
                           A   742    .BEGFUNC "read_levels",39,"_read_levels"
                           A   743    
                           A   744    .LINE 39
                           A   745    
                           A   746    .DEFINE "filename"
                           A   747    
                           A   748    .CLASS 65
                           A   749    
                           A   750    .VALUE 6
                           A   751    
                           A   752    .TYPE 34
                           A   753    
                           A   754    .ENDEF
                           A   755    
                           A   756    .DEFINE "levelbuffer"
                           A   757    
                           A   758    .CLASS 65
                           A   759    
                           A   760    .VALUE 9
                           A   761    
                           A   762    .TAG "sokobanlevel"
                           A   763    
                           A   764    .TYPE 296
                           A   765    
                           A   766    .ENDEF
                           A   767    
                           A   768    .DEFINE "fr"
                           A   769    
                           A   770    .CLASS 65
                           A   771    
                           A   772    .VALUE -3
                           A   773    
                           A   774    .TYPE 4
                           A   775    
                           A   776    .ENDEF
                           A   777    
                           A   778    .DEFINE "fSize"
                           A   779    
                           A   780    .CLASS 65
                           A   781    
                           A   782    .VALUE -7
                           A   783    
                           A   784    .TYPE 15
                           A   785    
                           A   786    .ENDEF
                           A   787    
                           A   788    .DEFINE "levels"
                           A   789    
                           A   790    .CLASS 65
                           A   791    
                           A   792    .VALUE -9
                           A   793    
                           A   794    .TYPE 13
                           A   795    
                           A   796    .ENDEF
                           A   797    
                           A   798    .DEFINE "br"
                           A   799    
                           A   800    .CLASS 65
                           A   801    
                           A   802    .VALUE -12
                           A   803    
                           A   804    .TYPE 14
                           A   805    
                           A   806    .ENDEF
                           A   807    
                           A   808    .DEFINE "fil"
                           A   809    
                           A   810    .CLASS 65
                           A   811    
                           A   812    .VALUE -560
                           A   813    
                           A   814    .TAG "NONAME6"
                           A   815    
                           A   816    .TYPE 8
                           A   817    
                           A   818    .ENDEF
                           A   819    
0000C3 DDE5                A   820    	PUSH	IX
0000C5 DD210000 00         A   821    	LD	IX,0
0000CA DD39                A   822    	ADD	IX,SP
0000CC 21D0FDFF            A   823    	LD	HL,-560
0000D0 39                  A   824    	ADD	HL,SP
0000D1 F9                  A   825    	LD	SP,HL
                           A   826    ;   40		FIL	   	fil;
                           A   827    ;   41		UINT   	br;	
                           A   828    ;   42		FSIZE_t fSize;
                           A   829    ;   43		UINT16	levels;
                           A   830    ;   44		FRESULT	fr;
                           A   831    ;   45	
                           A   832    ;   46		fr = f_open(&fil, filename, FA_READ
                           A   833    .LINE 46
                           A   834    
0000D2 01010000            A   835    	LD	BC,1
0000D6 C5                  A   836    	PUSH	BC
0000D7 DD0706              A   837    	LD	BC,(IX+%6)
0000DA C5                  A   838    	PUSH	BC
0000DB DDE5E1              A   839    	LD	HL,IX
0000DE 01D0FDFF            A   840    	LD	BC,-560
0000E2 09                  A   841    	ADD	HL,BC
0000E3 E5C1                A   842    	LD	BC,HL
0000E5 C5                  A   843    	PUSH	BC
0000E6 CD 00 00 00         A   844    	CALL	_f_open
0000EA C1                  A   845    	POP	BC
0000EB C1                  A   846    	POP	BC
0000EC C1                  A   847    	POP	BC
0000ED DD2FFD              A   848    	LD	(IX+%FFFFFFFD),HL
                           A   849    ;   47		if(fr == FR_OK) {
                           A   850    .LINE 47
                           A   851    
0000F0 01000000            A   852    	LD	BC,0
0000F4 DD27FD              A   853    	LD	HL,(IX+%FFFFFFFD)
0000F7 B7                  A   854    	OR	A,A
0000F8 ED42                A   855    	SBC	HL,BC
0000FA 20 5D               A   856    	JR	NZ,L_15
                           A   857    ;   48			fSize = f_size(&fil);
                           A   858    .LINE 48
                           A   859    
0000FC 21DBFDFF            A   860    	LD	HL,-549
000100 DDE5C1              A   861    	LD	BC,IX
000103 09                  A   862    	ADD	HL,BC
000104 ED07                A   863    	LD	BC,(HL)
000106 23                  A   864    	INC	HL
000107 23                  A   865    	INC	HL
000108 23                  A   866    	INC	HL
000109 7E                  A   867    	LD	A,(HL)
00010A DD0FF9              A   868    	LD	(IX+%FFFFFFF9),BC
00010D DD77FC              A   869    	LD	(IX+%FFFFFFFC),A
                           A   870    ;   49			*levelbuffer = (struct sokobanl
                           A   871    .LINE 49
                           A   872    
000110 DD07F9              A   873    	LD	BC,(IX+%FFFFFFF9)
000113 C5                  A   874    	PUSH	BC
000114 CD 00 00 00         A   875    	CALL	_malloc
000118 C1                  A   876    	POP	BC
000119 DD3109              A   877    	LD	IY,(IX+%9)
00011C FD2F00              A   878    	LD	(IY),HL
                           A   879    ;   50			fr = f_read(&fil, *levelbuffer,
                           A   880    .LINE 50
                           A   881    
00011F ED65F4              A   882    	PEA	IX+%FFFFFFF4
000122 DD07F9              A   883    	LD	BC,(IX+%FFFFFFF9)
000125 C5                  A   884    	PUSH	BC
000126 DD2709              A   885    	LD	HL,(IX+%9)
000129 ED07                A   886    	LD	BC,(HL)
00012B C5                  A   887    	PUSH	BC
00012C DDE5E1              A   888    	LD	HL,IX
00012F 01D0FDFF            A   889    	LD	BC,-560
000133 09                  A   890    	ADD	HL,BC
000134 E5C1                A   891    	LD	BC,HL
000136 C5                  A   892    	PUSH	BC
000137 CD 00 00 00         A   893    	CALL	_f_read
00013B C1                  A   894    	POP	BC
00013C C1                  A   895    	POP	BC
00013D C1                  A   896    	POP	BC
00013E C1                  A   897    	POP	BC
00013F DD2FFD              A   898    	LD	(IX+%FFFFFFFD),HL
                           A   899    ;   51			levels = fSize / sizeof(struct 
                           A   900    .LINE 51
                           A   901    
000142 DD27F9              A   902    	LD	HL,(IX+%FFFFFFF9)
000145 DD5EFC              A   903    	LD	E,(IX+%FFFFFFFC)
000148 01330100            A   904    	LD	BC,307
00014C AF                  A   905    	XOR	A,A
00014D CD 00 00 00         A   906    	CALL	__ldivu
000151 DD75F7              A   907    	LD	(IX+%FFFFFFF7),L
000154 DD74F8              A   908    	LD	(IX+%FFFFFFF8),H
                           A   909    ;   52		}
                           A   910    ;   53		else {
                           A   911    .LINE 53
                           A   912    
000157 18 17               A   913    	JR	L_16
000159                     A   914    L_15:
                           A   915    ;   54			mos_fileError(fr);
                           A   916    .LINE 54
                           A   917    
000159 DD07FD              A   918    	LD	BC,(IX+%FFFFFFFD)
00015C C5                  A   919    	PUSH	BC
00015D CD 00 00 00         A   920    	CALL	_mos_fileError
000161 C1                  A   921    	POP	BC
                           A   922    ;   55			free(levelbuffer);
                           A   923    .LINE 55
                           A   924    
000162 DD0709              A   925    	LD	BC,(IX+%9)
000165 C5                  A   926    	PUSH	BC
000166 CD 00 00 00         A   927    	CALL	_free
00016A C1                  A   928    	POP	BC
                           A   929    ;   56			return 0;
                           A   930    .LINE 56
                           A   931    
00016B B7                  A   932    	OR	A,A
00016C ED62                A   933    	SBC	HL,HL
00016E 18 13               A   934    	JR	L_17
                           A   935    ;   57		}
000170                     A   936    L_16:
                           A   937    .LINE 57
                           A   938    
                           A   939    ;   58		f_close(&fil);
                           A   940    .LINE 58
                           A   941    
000170 DDE5E1              A   942    	LD	HL,IX
000173 01D0FDFF            A   943    	LD	BC,-560
000177 09                  A   944    	ADD	HL,BC
000178 E5C1                A   945    	LD	BC,HL
00017A C5                  A   946    	PUSH	BC
00017B CD 00 00 00         A   947    	CALL	_f_close
00017F C1                  A   948    	POP	BC
                           A   949    ;   59		return levels;	
                           A   950    .LINE 59
                           A   951    
000180 DD27F7              A   952    	LD	HL,(IX+%FFFFFFF7)
                           A   953    ;   60	}
000183                     A   954    L_17:
                           A   955    .LINE 60
                           A   956    
000183 DDF9                A   957    	LD	SP,IX
000185 DDE1                A   958    	POP	IX
000187 C9                  A   959    	RET	
                           A   960    
                           A   961    
                           A   962    ;**************************** _read_levels ****
                           A   963    ;Name                         Addr/Register   S
                           A   964    ;_f_close                            IMPORT  --
                           A   965    ;_free                               IMPORT  --
                           A   966    ;_mos_fileError                      IMPORT  --
                           A   967    ;_f_read                             IMPORT  --
                           A   968    ;_malloc                             IMPORT  --
                           A   969    ;_f_open                             IMPORT  --
                           A   970    ;fil                                 IX-560    
                           A   971    ;br                                   IX-12    
                           A   972    ;levels                                IX-9    
                           A   973    ;fSize                                 IX-7    
                           A   974    ;fr                                    IX-3    
                           A   975    ;levelbuffer                           IX+9    
                           A   976    ;filename                              IX+6    
                           A   977    
                           A   978    
                           A   979    ; Stack Frame Size: 572 (bytes)
                           A   980    ;       Spill Code: 0 (instruction)
                           A   981    
                           A   982    
                           A   983    .ENDFUNC "read_levels",60,"_read_levels"
                           A   984    	XREF _mos_fileError:ROM
                           A   985    	XREF _f_read:ROM
                           A   986    	XREF _f_close:ROM
                           A   987    	XREF _f_open:ROM
                           A   988    	XREF _malloc:ROM
                           A   989    	XREF _free:ROM
                           A   990    	XREF ___print_sendstring:ROM
                           A   991    	XREF ___print_xputch:ROM
                           A   992    	XREF ___print_uputch:ROM
                           A   993    	XREF __ldivu:ROM
                           A   994    	XREF __stoiu:ROM
                           A   995    	XREF __imul_b:ROM
                           A   996    	XDEF _read_levels
                           A   997    	XDEF _print_playfieldText
                           A   998    	XDEF _lookup
                           A   999    	END


Errors: 0
Warnings: 0
Lines Assembled: 1000
